<!DOCTYPE html>
<html>
 <head>
   <title>Psychology Experiment</title>
   <!-- Load jsPsych and plugins -->
   <script src="https://unpkg.com/jspsych@8.0.0"></script>
   <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.0.0"></script>
   <script src="https://unpkg.com/@jspsych/plugin-survey-likert@2.0.0"></script>
   <link href="https://unpkg.com/jspsych@8.0.0/css/jspsych.css" rel="stylesheet" type="text/css" />
</head>
<body></body>
<script>
  // Initialize jsPsych
  const jsPsych = initJsPsych({
    on_finish: function () {
      jsPsych.data.displayData();
    }
  });

  // Create timeline array to store the sequence of trials
  const timeline = [];

  // Define Moral and Immoral story conditions
  const storyMoral = {
    type: jsPsychHtmlButtonResponse,  // Updated plugin structure for jsPsych 8
    stimulus: `
      <p>Justin and Nate each found a wallet with cash. Justin quickly decided to return the wallet, while Nate took some time but also returned it.</p>
    `,
    choices: ['Continue']
  };

  const storyImmoral = {
    type: jsPsychHtmlButtonResponse,
    stimulus: `
      <p>Justin and Nate each found a wallet with cash. Justin quickly decided to take the cash, while Nate took some time but also took it.</p>
    `,
    choices: ['Continue']
  };

  // Define Likert scale questions for Justin
  const questionsJustin = [
    {
      type: jsPsychSurveyLikert,
      questions: [
        { prompt: 'Did Justin make his decision quickly or slowly?', labels: ['Particularly slowly', '', '', '', '', '', 'Particularly quickly'], required: true }
      ]
    },
    {
      type: jsPsychSurveyLikert,
      questions: [
        { prompt: 'Does it sound like Justin has underlying moral principles that are good, bad, or somewhere in between?', labels: ['Completely bad', '', '', 'Mixed', '', '', 'Completely good'], required: true },
        { prompt: 'Does Justin have the moral knowledge to do “the right thing”?', labels: ['Not at all', '', '', 'Somewhat', '', '', 'Completely'], required: true }
      ]
    }
  ];

  // Define Likert scale questions for Nate
  const questionsNate = [
    {
      type: jsPsychSurveyLikert,
      questions: [
        { prompt: 'Did Nate make his decision quickly or slowly?', labels: ['Particularly slowly', '', '', '', '', '', 'Particularly quickly'], required: true }
      ]
    },
    {
      type: jsPsychSurveyLikert,
      questions: [
        { prompt: 'Does it sound like Nate has underlying moral principles that are good, bad, or somewhere in between?', labels: ['Completely bad', '', '', 'Mixed', '', '', 'Completely good'], required: true },
        { prompt: 'Does Nate have the moral knowledge to do “the right thing”?', labels: ['Not at all', '', '', 'Somewhat', '', '', 'Completely'], required: true }
      ]
    }
  ];

  // Randomize between Moral and Immoral conditions
  const condition = Math.random() > 0.5 ? 'moral' : 'immoral';

  if (condition === 'moral') {
    timeline.push(storyMoral, ...questionsJustin, ...questionsNate);
  } else {
    timeline.push(storyImmoral, ...questionsJustin, ...questionsNate);
  }

  // Start the experiment
  jsPsych.run(timeline);
</script>
</html>
